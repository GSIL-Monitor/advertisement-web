<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Article">
	<resultMap id="articleMap" type="Article">
		<id property="articleId" column="article_id" jdbcType="NUMERIC" />
		<result property="title" column="title" jdbcType="VARCHAR" />
		<result property="content" column="content" jdbcType="VARCHAR" />
		<result property="description" column="description" jdbcType="VARCHAR" />
		<result property="buttonLabel" column="button_label" jdbcType="VARCHAR" />
		<result property="buttonType" column="button_type" jdbcType="NUMERIC" />
		<result property="buttonLink" column="button_link" jdbcType="VARCHAR" />
		<result property="linkValue" column="link_value" jdbcType="VARCHAR" />
		<result property="source" column="source" jdbcType="VARCHAR" />
		<result property="imageUrl" column="image_url" jdbcType="VARCHAR" />
		<result property="contentType" column="content_type" jdbcType="NUMERIC" />
		<result property="weixinUrl" column="weixin_url" jdbcType="VARCHAR" />
		<result property="weixinShareTitle" column="weixin_share_title"
			jdbcType="VARCHAR" />
		<result property="weixinShareDesc" column="weixin_share_desc"
			jdbcType="VARCHAR" />
		<result property="category" column="category" jdbcType="NUMERIC" />
		<result property="status" column="status" jdbcType="NUMERIC" />
		<result property="createTime" column="create_time" jdbcType="TIMESTAMP" />
		<result property="updateTime" column="update_time" jdbcType="TIMESTAMP" />
	</resultMap>

	<select id="selectArticles" parameterType="Article" resultMap="articleMap">
		select
		* from
		tb_article a
		<where>
			<trim suffixOverrides="and">
				<if test="articleId != null">
					article_id=#{articleId} and
				</if>
				<if test="title != null">
					title=#{title} and
				</if>
				<if test="source != null">
					source=#{source} and
				</if>
				<if test="description != null">
					description=#{description} and
				</if>
				<if test="linkValue != null">
					link_value=#{linkValue} and
				</if>
				<if test="contentType != null">
					content_type=#{contentType} and
				</if>
				<if test="weixinShareTitle != null">
					weixin_share_title=#{weixinShareTitle} and
				</if>
				<if test="weixinShareDesc != null">
					weixin_share_desc=#{weixinShareDesc} and
				</if>
				<if test="category != null">
					category=#{category} and
				</if>
				<if test="status != null">
					status = #{status} and
				</if>
			</trim>
			and status != -1
		</where>
		order by create_time desc
	</select>

	<insert id="insertArticle" parameterType="Article">
		insert into
		tb_article(link_value, title, content, description, button_label,
		button_type, button_link, source, image_url, content_type, category, status,
		weixin_url, weixin_share_title, weixin_share_desc, create_time,
		update_time)
		values
		(#{linkValue}, #{title}, #{content}, #{description},
		#{buttonLabel}, #{buttonType}, #{buttonLink}, #{source}, #{imageUrl},
		#{contentType}, #{category}, #{status}, #{weixinUrl},
		#{weixinShareTitle},
		#{weixinShareDesc}, sysdate(), sysdate())
		<selectKey resultType="java.lang.Long" order="AFTER"
			keyProperty="articleId">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>

	<update id="updateArticle" parameterType="Article">
		update tb_article
		<set>
			<trim suffixOverrides=",">
				<if test="title != null">
					title=#{title},
				</if>
				<if test="content != null">
					content=#{content},
				</if>
				<if test="description != null">
					description=#{description},
				</if>
				<if test="buttonLabel != null">
					button_label=#{buttonLabel},
				</if>
				<if test="buttonType != null">
					button_type=#{buttonType},
				</if>
				<if test="buttonLink != null">
					button_link=#{buttonLink},
				</if>
				<if test="source != null">
					source=#{source},
				</if>
				<if test="imageUrl != null">
					image_url=#{imageUrl},
				</if>
				<if test="linkValue != null">
					link_value=#{linkValue},
				</if>
				<if test="contentType != null">
					content_type=#{contentType},
				</if>
				<if test="weixinUrl != null">
					weixin_url=#{weixinUrl},
				</if>
				<if test="weixinShareTitle != null">
					weixin_share_title=#{weixinShareTitle},
				</if>
				<if test="weixinShareDesc != null">
					weixin_share_desc=#{weixinShareDesc},
				</if>
				<if test="category != null">
					category=#{category},
				</if>
				<if test="status != null">
					status=#{status},
				</if>
				update_time=sysdate(),
			</trim>
		</set>
		<where>
			article_id=#{articleId}
		</where>
	</update>

	<delete id="deleteArticle" parameterType="Article">
		delete from tb_article
		where
		article_id=#{articleId}
	</delete>

</mapper>