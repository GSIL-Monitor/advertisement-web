<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="ArticleSection">
	<resultMap id="articleSectionMap" type="ArticleSection">
		<id property="sectionId" column="section_id" jdbcType="NUMERIC" />
		<result property="articleId" column="article_id" jdbcType="NUMERIC" />
		<result property="title" column="title" jdbcType="VARCHAR" />
		<result property="content" column="content" jdbcType="VARCHAR" />
		<result property="description" column="description" jdbcType="VARCHAR" />
		<result property="buttonLabel" column="button_label" jdbcType="VARCHAR" />
		<result property="buttonType" column="button_type" jdbcType="NUMERIC" />
		<result property="buttonLink" column="button_link" jdbcType="VARCHAR" />
		<result property="imageUrl" column="image_url" jdbcType="VARCHAR" />
		<result property="sort" column="sort" jdbcType="NUMERIC" />
		<result property="contentType" column="content_type" jdbcType="NUMERIC" />
		<result property="status" column="status" jdbcType="NUMERIC" />
		<result property="createTime" column="create_time" jdbcType="TIMESTAMP" />
		<result property="updateTime" column="update_time" jdbcType="TIMESTAMP" />
	</resultMap>
	
	<select id="selectArticleSectionByArticleIds" parameterType="List" resultMap="articleSectionMap">
		select
		* from
		tb_article_section
		<where>
			article_id in
			<foreach item="id" collection="list" open="(" separator=","
				close=")">
				#{id}
			</foreach>
			and status != -1
		</where>
	</select>

	<select id="selectArticleSections" parameterType="ArticleSection"
		resultMap="articleSectionMap">
		select
		* from
		tb_article_section s
		<where>
			<trim suffixOverrides="and">
				<if test="sectionId != null">
					section_id=#{sectionId} and
				</if>
				<if test="articleId != null">
					article_id=#{articleId} and
				</if>
				<if test="title != null">
					title=#{title} and
				</if>
				<if test="content != null">
					content=#{content} and
				</if>
				<if test="description != null">
					description=#{description} and
				</if>
				<if test="contentType != null">
					content_type=#{contentType} and
				</if>
				<if test="status != null">
					status = #{status} and
				</if>
			</trim>
			and status != -1
		</where>
		order by sort asc, create_time desc
	</select>

	<insert id="insertArticleSection" parameterType="ArticleSection">
		insert into
		tb_article_section(article_id, title, content, description,
		button_label, button_type, button_link, image_url, sort, status,
		content_type, create_time, update_time)
		values
		(#{articleId}, #{title},
		#{content}, #{description}, #{buttonLabel}, #{buttonType},
		#{buttonLink}, #{imageUrl}, #{sort},
		#{status}, #{contentType}, sysdate(), sysdate())
	</insert>

	<update id="updateArticleSection" parameterType="ArticleSection">
		update tb_article_section
		<set>
			<trim suffixOverrides=",">
				<if test="articleId != null">
					article_id=#{articleId},
				</if>
				<if test="title != null">
					title=#{title},
				</if>
				<if test="content != null">
					content=#{content},
				</if>
				<if test="description != null">
					description=#{description},
				</if>
				<if test="buttonLabel != null">
					button_label=#{buttonLabel},
				</if>
				<if test="buttonType != null">
					button_type=#{buttonType},
				</if>
				<if test="buttonLink != null">
					button_link=#{buttonLink},
				</if>
				<if test="imageUrl != null">
					image_url=#{imageUrl},
				</if>
				<if test="sort != null">
					sort=#{sort},
				</if>
				<if test="contentType != null">
					content_type=#{contentType},
				</if>
				<if test="status != null">
					status=#{status},
				</if>
				update_time=sysdate(),
			</trim>
		</set>
		<where>
			section_id=#{sectionId}
		</where>
	</update>

	<delete id="deleteArticleSection" parameterType="ArticleSection">
		delete from
		tb_article_section
		where
		section_id=#{sectionId}
	</delete>

</mapper>